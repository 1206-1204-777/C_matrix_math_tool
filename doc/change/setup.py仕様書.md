## 1. `setup.py` 設計書

### 【設計の目的】

1. **ビルドの自動化**: `gcc` などのコンパイラを手動で叩く手間を排除し、環境（Linux/macOS/Windows）に合わせた共有ライブラリを生成する。
2. **パッケージ管理**: `pip install .` や `pip install -e .`（編集可能モード）によって、自作ライブラリをPythonの標準ライブラリ群と同じように扱えるようにする。
3. **Cコードの同梱**: ソースコード（`matrix.c`, `matrix.h`）をパッケージに含め、インストール時にターゲット環境で最適にコンパイルされるようにする。

---

### 【主要構成要素】

| 要素 | 設計内容 | 備考 |
| --- | --- | --- |
| **Metadata** | [パッケージ名:`MTools`, バージョン: `1.0.1`, ライセンス:`MIT License`, 作者情報:`K`] | `setup()` 関数の引数として定義 |
| **Extension Module** | [`src/matrix.c`, `include/matrix.h`] | `setuptools.Extension` を使用 |
| **Shared Library Naming** | [出力バイナリ名: `MTools.so`, パッケージ内配置パス: `build/MTools.so`] |  |
| **Build Options** | [OS固有フラグ: `compile_args`] | 最適化（`-O3`）や位置独立コード（`-fPIC`）の定義 |

---

### 【配布・資産管理の設計】

| 項目 | 定義内容 | 役割 |
| --- | --- | --- |
| **MANIFEST.in** | [README, LICENSE] |  |
| **pyproject.toml** | [`setuptools`, `wheel`] | その他、依存関係を記述 |

---

### 【ビルド・フローの設計】

1. **ソース・ヘッダー特定**: `src/` 等のディレクトリからコンパイルに必要な全資産をスキャンする。
2. **環境判定**: 実行OS（POSIX / NT）を判定し、適切なコンパイラオプションを選択する。
3. **コンパイル・リンク**: オブジェクトファイルの生成後、共有ライブラリ（`.so` / `.dll`）としてリンクを行う。
4. **インストール・配置**: 指定したパッケージディレクトリ（例: `py_matrix/`）へ成果物を配置し、Pythonパスを通す。
5. **クリーンアップ**: ビルド過程で生成された一時ファイル（`build/`, `*.pyc`）の処理。

